# VectorEngine 성능 벤치마크 결과 (현실적 시나리오)

-   **측정 일시**: 2025년 7월 11일
-   **목표**: `VectorEngine`의 실제 사용 시나리오(초기 로딩, 증분 추가, 검색)에 대한 성능 기준선 설정
-   **실행 명령어**: `cargo bench --bench engine_benchmark`

## 📊 벤치마크 환경

-   **CPU**: `AMD Ryzen 5 5600U with Radeon Graphics`
-   **RAM**: `8 GB`
-   **OS**: `Windows 11`
-   **Rustc 버전**: `1.86.0`
-   **주요 의존성 버전**:
    -   `instant-distance`: 0.2.0
    -   `rand`: 0.7.3

## 📝 결과 요약

| 벤치마크 항목 | 평균 실행 시간 |
| :--- | :--- |
| **`1_load_from_bytes_1000_docs`** | **~23.75 s** |
| **`2_add_and_rebuild_on_1000_docs`** | **~24.03 s** |
| **`3_search_in_1000_docs`** | **~2.14 µs** |

## 🔬 상세 결과 및 분석

### 1. 초기 로딩 (1_load_from_bytes_1000_docs)

-   **내용**: 1536차원 벡터 1,000개를 담은 바이트 배열로부터 엔진과 인덱스를 완전히 로드하는 작업.
-   **시간**: `[23.580 s 23.750 s 23.928 s]`
-   **분석**: 앱이 시작될 때 저장된 데이터를 불러와 검색 가능한 상태로 만드는 데 평균 약 **23.75초**가 소요됩니다. 이는 사용자가 초기 로딩 시 경험하게 될 시간입니다.

### 2. 증분 추가 (2_add_and_rebuild_on_1000_docs)

-   **내용**: 1,000개 문서가 있는 엔진에 새로운 문서 1개를 추가하고 인덱스를 재구성하는 작업.
-   **시간**: `[23.651 s 24.028 s 24.436 s]`
-   **분석**: 단일 문서를 추가(또는 수정/삭제)하는 데 평균 약 **24.03초**가 소요됩니다. 이 시간의 대부분은 인덱스 전체를 재구성하는 데 사용됩니다.

### 3. 순수 검색 (3_search_in_1000_docs)

-   **내용**: 1,000개 문서가 저장된 엔진에서 유사도 높은 상위 10개 문서를 검색하는 작업.
-   **시간**: `[2.1297 µs 2.1396 µs 2.1516 µs]`
-   **분석**: 인덱스가 준비된 상태에서의 검색 속도는 평균 약 **2.14 마이크로초(µs)**로 매우 빠릅니다.

## 💡 결론 및 향후 계획

-   **인덱스 재구성 비용이 지배적**: `load_from_bytes`와 `add_document`의 성능이 거의 동일하게 측정되었습니다. 이는 두 작업 모두 **인덱스 전체를 재구성(`rebuild_index`)하는 비용**이 대부분을 차지하며, 데이터 역직렬화나 `HashMap`에 추가하는 비용은 그에 비해 무시할 수 있을 정도로 작다는 것을 의미합니다.

-   **사용자 경험(UX) 전략 확정**: 약 24초에 달하는 인덱싱 시간은 사용자에게 직접적인 대기 시간으로 노출되어서는 안 됩니다. 따라서 플러그인 초기 로딩이나 문서 추가/수정/삭제 시, 이 작업들을 **백그라운드에서 비동기적으로 처리**하고 사용자에게는 **'색인 중...'과 같은 상태 메시지를 명확히 보여주는 것**이 필수적입니다.

-   **향후 과제**: 현재의 빠른 검색 속도는 매우 긍정적입니다. 향후 프로젝트의 완성도를 높이는 과정에서 만약 이 긴 인덱싱 시간이 문제가 된다면, 그때 가서 '인덱스 상태 저장'을 지원하는 다른 라이브러리로의 전환을 재검토할 수 있습니다.